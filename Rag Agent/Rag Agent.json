{
  "name": "Rag Agent",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -420,
        0
      ],
      "id": "e797ee36-fd84-434f-bf3c-8c57416e2080",
      "name": "When chat message received",
      "webhookId": "86ad4787-7f3e-41ab-80a4-ca6fdfb0556a",
      "notesInFlow": false
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=You are an AI assistant that answers questions using a knowledge base stored in Qdrant. You must ALWAYS cite your sources and provide cross-references between related documents.\n\n**Enhanced Response Requirements:**\n1. **Multi-document Analysis**: For complex questions, search across ALL relevant documents\n2. **Cross-referencing**: When citing information, link related concepts from different documents\n3. **Process Flow**: For process questions, show the complete flow across documents\n4. **Code Quality Integration**: Connect development processes with quality standards\n\n**Mandatory Response Format:**\n1. **Complete Answer**\n[Provide comprehensive answer with cross-document insights]\n\n2. **Cross-Document Citations**\nProcess Flow:\n- Step 1: [Document A] - [specific content]\n- Step 2: [Document B] - [specific content]\n- Step 3: [Document C] - [specific content]\n\n3. **Quality Standards Referenced**\n[List applicable standards from standard_java.pdf]\n\n4. **Source Metadata**\nPrimary Sources:\nFile: [file_name] | Chunk: [chunk_id] | Score: [score]\nSupporting Sources:\nFile: [file_name] | Chunk: [chunk_id] | Score: [score]\n\n**Special Instructions for Process Questions:**\n- Always check commit_process.pdf, review_process.pdf, and standard_java.pdf\n- Show the relationship between development steps and quality requirements\n- Provide specific examples from the standards when relevant"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -160,
        0
      ],
      "id": "92ad48b8-3a1c-4232-8dec-6bfd97a5fa09",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "=Search through the knowledge base for comprehensive answers. \nPrioritize cross-document connections for process-related questions.",
        "qdrantCollection": {
          "__rl": true,
          "value": "Base de connaisance",
          "mode": "list",
          "cachedResultName": "Base de connaisance"
        },
        "topK": 15,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreQdrant",
      "typeVersion": 1.3,
      "position": [
        40,
        222.5
      ],
      "id": "ecd2d2ab-dd64-4490-8638-34fce22deccc",
      "name": "Qdrant Vector Store",
      "credentials": {
        "qdrantApi": {
          "id": "sFfERYppMeBnFNeA",
          "name": "Local QdrantApi database"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -200,
        220
      ],
      "id": "f976fa9b-047a-47cd-a40c-982d98d6046c",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "adbeya8JlzChQ2dk",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "dimensions": 1536
        }
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        120,
        420
      ],
      "id": "9f528640-a32e-46c4-8331-86ac38bd68f4",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "adbeya8JlzChQ2dk",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "contextWindowLength": 15
      },
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        -80,
        220
      ],
      "id": "1516f0e9-9257-4d02-87a1-49a41419d6ed",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "n8LaHccthse0BiXp",
          "name": "Postgres account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Qdrant Vector Store": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "Qdrant Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "2db42221-0421-4a15-98c1-12fca6f634f0",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "558d88703fb65b2d0e44613bc35916258b0f0bf983c5d4730c00c424b77ca36a"
  },
  "id": "CSUycpz1etEdDrg6",
  "tags": []
}